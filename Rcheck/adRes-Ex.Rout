
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "adRes"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> base::assign(".ExTimings", "adRes-Ex.timings", pos = 'CheckExEnv')
> base::cat("name\tuser\tsystem\telapsed\n", file=base::get(".ExTimings", pos = 'CheckExEnv'))
> base::assign(".format_ptime",
+ function(x) {
+   if(!is.na(x[4L])) x[1L] <- x[1L] + x[4L]
+   if(!is.na(x[5L])) x[2L] <- x[2L] + x[5L]
+   options(OutDec = '.')
+   format(x[1L:3L], digits = 7L)
+ },
+ pos = 'CheckExEnv')
> 
> ### * </HEADER>
> library('adRes')

 Welcome to adRes,
 
 This package has been created to document the analysis of the paper:
 Adaptive responses of animals to climate change are most likely insufficient
 by Radchuk et al. Nature Communications (2019).
 
 Type ?adRes for information about how to use this package!
 
 WARNING: this package has not been conceived for general use.

> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("adRes-package")
> ### * adRes-package
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: adRes-package
> ### Title: Assessing whether phenotypic changes in response to climate are
> ###   adaptive
> ### Aliases: adRes-package adRes
> ### Keywords: package
> 
> ### ** Examples
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####              Settings for the workflow              ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  nb_cores <- 2L ## increase the number for using more cores
>  digit <- 3L
>  par_ini <- par(no.readonly = TRUE) ## default parameters for display
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####              Temperature: Condition 1              ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ## for PRCS
>  mod_T_prcs <- fit_all(data = dat_Clim, temperature = TRUE,
+                        precipitation = FALSE, phenology = TRUE,
+                        morphology = TRUE, condition = '1',
+                        nb_cores = nb_cores, rand_trait = FALSE,
+                        fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0375; se = 0.0083"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 14.68826  1 0.0001268337
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
6.43e-01 2.80e+00 3.57e-01 8.35e+01 7.77e-06 3.80e-04 6.85e-04 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## for PRC
>  ## Not run: 
> ##D  mod_T_prc <- fit_all(data = dat_Clim_prc, temperature = TRUE,
> ##D                       precipitation = FALSE, phenology = TRUE,
> ##D                       morphology = TRUE, condition = '1',
> ##D                       nb_cores = nb_cores, rand_trait = FALSE,
> ##D                       fixed = NULL, digit = digit)
> ##D 
> ##D  ## forest plot as in Fig. 2
> ##D  par(par_ini)
> ##D  plot_T_cond1 <- plot_forest(meta_obj1 = mod_T_prcs$meta_res,
> ##D                              meta_obj2 = NULL,
> ##D                              list_extra_meta_obj =
> ##D                              list(mod_T_prcs$meta_res, mod_T_prc$meta_res),
> ##D                              sort = c("Coord"),
> ##D                              increasing = FALSE,
> ##D                              labels = c(traits = FALSE,
> ##D                                         fitness = FALSE,
> ##D                                         country = TRUE,
> ##D                                         authors = FALSE))
> ##D  mtext('Across', side = 2, line = 3,
> ##D        at = -1, las = 2, cex = 0.9, col = 'black')
> ##D  mtext('studies', side = 2, line = 3,
> ##D        at = -2, las = 2, cex = 0.9, col = 'black')
> ##D  
> ## End(Not run)
> 
>  ## plots of raw data and extracted slopes per study, as in Suppl. Fig. S11
>  par(par_ini); par(oma = c(3, 5, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Clim, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE, morphology = TRUE,
+           condition = '1', id_to_do = c(1:20))
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
> 
>  ## in the full dataset there are 41 ids (21_41). In the publicly shared 36
>  par(par_ini); par(oma = c(3, 5, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Clim, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE,
+           morphology = TRUE, condition = '1',
+           id_to_do = c(21:36))
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####        Temperature: Condition 2, phenology         ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ## for PRCS
>  mod_phen_T_prcs <- fit_all(data = dat_Trait, temperature = TRUE,
+                             precipitation = FALSE, phenology = TRUE,
+                             morphology = FALSE, condition = '2',
+                             nb_cores = nb_cores, rand_trait = FALSE,
+                             fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.248; se = 0.0637"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 10.96916  1 0.0009264073
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.05e-01 1.05e+01 9.53e-02 2.92e+02 1.95e-41 7.02e-03 6.66e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_phen_T_prcs_Type <- fit_all(data = dat_Trait,
+                                  temperature = TRUE, precipitation = FALSE,
+                                  phenology = TRUE, morphology = FALSE,
+                                  condition = '2', nb_cores = nb_cores,
+                                  rand_trait = FALSE, fixed = 'Trait_Cat',
+                                  digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.185; se = 0.142"  "slope = -0.264; se = 0.0769"
[3] "slope = -0.328; se = 0.155" 

########### Global ANOVA ###########
Fixed effect of  Trait_Cat 
      chi2_LR df   p_value
p_v 0.5211474  2 0.7706094
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.05e-01 1.05e+01 9.53e-02 2.92e+02 1.95e-41 7.02e-03 6.66e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## for PRC
>  ## Not run: 
> ##D  mod_phen_T_prc <- fit_all(data = dat_Trait_prc,
> ##D                            temperature = TRUE, precipitation = FALSE,
> ##D                            phenology = TRUE, morphology = FALSE,
> ##D                            condition = '2', nb_cores = nb_cores,
> ##D                            rand_trait = FALSE, fixed = NULL,
> ##D                            digit = digit)
> ##D 
> ##D  ## fixed effects
> ##D  mod_phen_T_prc_Type <- fit_all(data = dat_Trait_prc,
> ##D                                 temperature = TRUE, precipitation = FALSE,
> ##D                                 phenology = TRUE, morphology = FALSE,
> ##D                                 condition = '2', nb_cores = nb_cores,
> ##D                                 rand_trait = FALSE, fixed = 'Trait_Cat',
> ##D                                 digit = digit)
> ##D 
> ##D  mod_phen_T_prc_Taxon <- fit_all(data = dat_Trait_prc,
> ##D                                  temperature = TRUE, precipitation = FALSE,
> ##D                                  phenology = TRUE, morphology = FALSE,
> ##D                                  condition = '2', nb_cores = nb_cores,
> ##D                                  rand_trait = FALSE, fixed = 'Taxon',
> ##D                                  digit = digit)
> ##D  
> ## End(Not run)
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####        Temperature: Condition 2, morphology        ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ## for PRCS
>  mod_morph_T_prcs <- fit_all(data = dat_Trait, temperature = TRUE,
+                              precipitation = FALSE, phenology = FALSE,
+                              morphology = TRUE, condition = '2',
+                              nb_cores = nb_cores, rand_trait = FALSE,
+                              fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0353; se = 0.115"

########### Global ANOVA ###########
       chi2_LR df   p_value
p_v 0.09372053  1 0.7594995
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.94e-06 1.00e+00 1.00e+00 1.04e+00 7.91e-01 5.33e-02 3.17e-07 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_morph_T_prcs_Type <- fit_all(data = dat_Trait,
+                                   temperature = TRUE, precipitation = FALSE,
+                                   phenology = FALSE, morphology = TRUE,
+                                   condition = '2', nb_cores = nb_cores,
+                                   rand_trait = FALSE, fixed = 'Morph_type',
+                                   digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0798; se = 0.242" "slope = -0.012; se = 0.246"

########### Global ANOVA ###########
Fixed effect of  Morph_type 
      chi2_LR df   p_value
p_v 0.1582727  1 0.6907518
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.94e-06 1.00e+00 1.00e+00 1.04e+00 7.91e-01 5.33e-02 3.17e-07 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## for PRC
>  ## Not run: 
> ##D    mod_morph_T_prc <- fit_all(data = dat_Trait_prc,
> ##D                               temperature = TRUE, precipitation = FALSE,
> ##D                               phenology = FALSE, morphology = TRUE,
> ##D                               condition = '2', nb_cores = nb_cores,
> ##D                               rand_trait = FALSE, fixed = NULL,
> ##D                               digit = digit)
> ##D 
> ##D    ## fixed effects
> ##D    mod_morph_T_prc_Type <- fit_all(data = dat_Trait_prc,
> ##D                                    temperature = TRUE, precipitation = FALSE,
> ##D                                    phenology = FALSE, morphology = TRUE,
> ##D                                    condition = '2', nb_cores = nb_cores,
> ##D                                    rand_trait = FALSE, fixed = 'Morph_type',
> ##D                                    digit = digit)
> ##D 
> ##D    mod_morph_T_prc_Taxon <- fit_all(data = dat_Trait_prc,
> ##D                                     temperature = TRUE, precipitation = FALSE,
> ##D                                     phenology = FALSE, morphology = TRUE,
> ##D                                     condition = '2', nb_cores = nb_cores,
> ##D                                     rand_trait = FALSE, fixed = 'Taxon',
> ##D                                     digit = digit)
> ##D 
> ##D    mod_morph_T_prc_Therm <- fit_all(data = dat_Trait_prc,
> ##D                                     temperature = TRUE, precipitation = FALSE,
> ##D                                     phenology = FALSE, morphology = TRUE,
> ##D                                     condition = '2', nb_cores = nb_cores,
> ##D                                     rand_trait = FALSE, fixed = 'Blood',
> ##D                                     digit = digit)
> ##D 
> ##D 
> ##D  ## forest plot as in Fig. 3
> ##D  par(par_ini)
> ##D  plot_T_cond2 <- plot_forest(meta_obj1 = mod_phen_T_prcs$meta_res,
> ##D                              meta_obj2 = mod_morph_T_prcs$meta_res,
> ##D                              list_extra_meta_obj =
> ##D                              list(mod_phen_T_prcs$meta_res,
> ##D                                   mod_morph_T_prcs$meta_res,
> ##D                                   mod_phen_T_prc$meta_res,
> ##D                                   mod_phen_T_prc_Taxon$meta_res,
> ##D                                   mod_morph_T_prc$meta_res,
> ##D                                   mod_morph_T_prc_Taxon$meta_res),
> ##D                              sort = c('Species', 'Trait_Categ_det',
> ##D                                       'PaperID'),
> ##D                              increasing = TRUE,
> ##D                              labels = c(traits = TRUE,
> ##D                                         fitness = FALSE,
> ##D                                         country = FALSE,
> ##D                                         authors = FALSE))
> ##D  mtext('Across studies, ', at = -0.6, side = 2,
> ##D        line = 4, las = 2, cex = 0.9, col = 'black')
> ##D  mtext('PRCS dataset', at = -2.2, side = 2,
> ##D         line = 4.3, las = 2, cex = 0.9, col = 'black')
> ##D  mtext('Across studies, ', at = -7.4, side = 2,
> ##D        line = 4, las = 2, cex = 0.9, col = 'black')
> ##D  mtext('PRC dataset ', at = -9, side = 2,
> ##D        line = 4.3, las = 2, cex = 0.9, col = 'black')
> ##D  
> ## End(Not run)
> 
>  ## plots of raw data and extracted slopes per study, as in Suppl. Fig. S12-S13
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Trait, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE,
+           morphology = FALSE, condition = '2',
+           id_to_do = c(1:20))
Warning in .predict_body(object = object, newdata = newdata, re.form = re.form,  :
  Prior weights are not taken in account in residVar computation.
> 
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Trait, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE,
+           morphology = FALSE, condition = '2',
+           id_to_do = c(21:38))
> 
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Trait, temperature = TRUE,
+           precipitation = FALSE, phenology = FALSE,
+           morphology = TRUE, condition = '2',
+           id_to_do = c(1:4))
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####               Temperature: Condition 3             ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ## phenology
>  mod_Sel_T_phen <- fit_all(data = dat_Sel, temperature = TRUE,
+                            precipitation = FALSE, phenology = TRUE,
+                            morphology = FALSE, condition = '3',
+                            nb_cores = nb_cores, rand_trait = FALSE,
+                            fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.165; se = 0.0652"

########### Global ANOVA ###########
     chi2_LR df    p_value
p_v 5.718049  1 0.01679138
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_Sel_T_phen_Fitn <- fit_all(data = dat_Sel, temperature = TRUE,
+                                 precipitation = FALSE, phenology = TRUE,
+                                 morphology = FALSE, condition = '3',
+                                 nb_cores = nb_cores, rand_trait = FALSE,
+                                 fixed = 'Fitness_Categ', digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.235; se = 0.0806"  "slope = -0.156; se = 0.0695" 
[3] "slope = -0.0871; se = 0.0899"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df   p_value
p_v 3.534851  2 0.1707721
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_T_phen_Gener <- fit_all(data = dat_Sel, temperature = TRUE,
+                                  precipitation = FALSE, phenology = TRUE,
+                                  morphology = FALSE, condition = '3',
+                                  nb_cores = nb_cores, rand_trait = FALSE,
+                                  fixed = 'GenerationLength_yr',
+                                  digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.019; se = 0.0111"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
      chi2_LR df   p_value
p_v 0.3574648  1 0.5499176
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
>  ## morphology
>  mod_Sel_T_morph <- fit_all(data = dat_Sel, temperature = TRUE,
+                             precipitation = FALSE, phenology = FALSE,
+                             morphology = TRUE, condition = '3',
+                             nb_cores = nb_cores, rand_trait = FALSE,
+                             fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.056; se = 0.0599"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.093157  1 0.2957728
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.73e-01 3.64e+01 2.75e-02 1.16e+02 1.95e-21 1.07e-04 3.81e-03 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
>  ## fixed effects
>  mod_Sel_T_morph_Fitn <- fit_all(data = dat_Sel, temperature = TRUE,
+                                  precipitation = FALSE, phenology = FALSE,
+                                  morphology = TRUE, condition = '3',
+                                  nb_cores = nb_cores, rand_trait = FALSE,
+                                  fixed = 'Fitness_Categ', digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.124; se = 0.0778"  "slope = 0.0629; se = 0.0653"
[3] "slope = 0.0481; se = 0.0651"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df   p_value
p_v 3.214133  2 0.2004748
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.73e-01 3.64e+01 2.75e-02 1.16e+02 1.95e-21 1.07e-04 3.81e-03 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_T_morph_Gener <- fit_all(data = dat_Sel, temperature = TRUE,
+                                   precipitation = FALSE, phenology = FALSE,
+                                   morphology = TRUE, condition = '3',
+                                   nb_cores = nb_cores, rand_trait = FALSE,
+                                   fixed = 'GenerationLength_yr',
+                                   digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.00461; se = 0.00907"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
      chi2_LR df   p_value
p_v 0.4667919  1 0.4944668
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.73e-01 3.64e+01 2.75e-02 1.16e+02 1.95e-21 1.07e-04 3.81e-03 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
>  ## forest plot as in Fig. 4
>  par(par_ini)
>  plot_Sel_T_cond3 <- plot_forest(meta_obj1 = mod_Sel_T_phen$meta_res,
+                          meta_obj2 = mod_Sel_T_morph$meta_res,
+                          list_extra_meta_obj =
+                          list(mod_Sel_T_phen$meta_res,
+                               mod_Sel_T_morph$meta_res,
+                               mod_Sel_T_phen_Fitn$meta_res),
+                          sort = c('Species', 'Fitness_Categ', 'PaperID'),
+                          increasing = TRUE,
+                          labels = c(traits = TRUE,
+                                     fitness = TRUE,
+                                     country = FALSE,
+                                     authors = FALSE))
Warning in graphics::arrows(x0 = data_plot[i, "lwr"], x1 = data_plot[i,  :
  zero-length arrow is of indeterminate angle and so skipped
>  mtext('Across', side = 2, line = 4.5, at = -2.2,
+        las = 2, cex = 0.85, col = 'black')
>  mtext('studies', side = 2, line = 4.5, at = -3.4,
+        las = 2, cex = 0.85, col = 'black')
> 
>  ## plot of raw data for supplementary, as in S14-S15
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Sel, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE, morphology = FALSE,
+           condition = '3', id_to_do = c(1:20))
> 
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Sel, temperature = TRUE,
+           precipitation = FALSE, phenology = TRUE, morphology = FALSE,
+           condition = '3', id_to_do = c(21:36))
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in .calc_logdisp_cov(object, dvdloglamMat = dvdloglamMat, dvdlogphiMat = dvdlogphiMat,  :
  Numerical precision issue or something else?
   Information matrix for dispersion parameters does not seem positive-definite.
   The prediction variance may be inaccurate.
> 
>  par(par_ini); par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
>  plot_raw(data = dat_Sel, temperature = TRUE,
+           precipitation = FALSE, phenology = FALSE, morphology = TRUE,
+           condition = '3', id_to_do = c(1:9))
> 
>  ## change of selection over years, phenology
>  mod_Sel_T_phen_year <- fit_all(data = dat_Sel, temperature = TRUE,
+                                 precipitation = FALSE, phenology = TRUE,
+                                 morphology = FALSE, condition = '3b',
+                                 nb_cores = nb_cores, rand_trait = FALSE,
+                                 fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?

########### Global slope ###########
[1] "slope = 0.000697; se = 0.00196"
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 0.154424  1 0.6943429
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
8.93e-01 9.38e+00 1.07e-01 1.30e+02 7.21e-13 2.93e-06 2.45e-05 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
>  ## change of selection over years, morphology
>  mod_Sel_T_morph_year <- fit_all(data = dat_Sel, temperature = TRUE,
+                                 precipitation = FALSE, phenology = FALSE,
+                                 morphology = TRUE, condition = '3b',
+                                 nb_cores = nb_cores, rand_trait = FALSE,
+                                 fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?

########### Global slope ###########
[1] "slope = 0.000761; se = 0.00102"
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 0.560182  1 0.4541869
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
2.47e-01 1.33e+00 7.53e-01 1.66e+01 3.40e-02 3.07e-06 1.00e-06 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  par(par_ini)
>  plot_Sel_T_overYrs <- plot_forest(meta_obj1 = mod_Sel_T_phen_year$meta_res,
+                        meta_obj2 = mod_Sel_T_morph_year$meta_res,
+                        list_extra_meta_obj =
+                        list(mod_Sel_T_phen_year$meta_res,
+                             mod_Sel_T_morph_year$meta_res),
+                        sort = c('Species', 'Study_Authors',
+                                  'Fitness_Categ'),
+                        increasing = TRUE,
+                        labels = c(traits = TRUE,
+                                   fitness = TRUE,
+                                   country = FALSE,
+                                   authors = FALSE))
>  mtext('Across', side = 2, line = 6, at = -1,
+        las = 2, cex = 0.8, col = 'black')
>  mtext('studies', side = 2, line = 6, at = -2.2,
+        las = 2, cex = 0.8, col = 'black')
> 
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> ####  Assess whether responses are adaptive: products of slopes             #
> ####   from conditions 1 & 2 vs. the slopes from condition 3                #
> ####                       binomial test                                    #
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  # assess condition 3: whether response is adaptive?
>  ## extracting slopes
>  all_slopes_phen <- merge_3slopes(meta_obj = mod_T_prcs,
+                                 meta_obj1 = mod_phen_T_prcs,
+                                 meta_obj2 = mod_Sel_T_phen)
> 
> all_slopes_morph <- merge_3slopes(meta_obj = mod_T_prcs,
+                                  meta_obj1 = mod_morph_T_prcs,
+                                  meta_obj2 = mod_Sel_T_morph)
>  ## testing adaptation
>  res_phen <- table(all_slopes_phen$slope.x * all_slopes_phen$slope.y > 0)
> 
>  (bc_phenT <- binom.confint(res_phen["TRUE"], sum(res_phen)))
          method  x  n      mean     lower     upper
1  agresti-coull 24 36 0.6666667 0.5025498 0.7986440
2     asymptotic 24 36 0.6666667 0.5126774 0.8206560
3          bayes 24 36 0.6621622 0.5108925 0.8086134
4        cloglog 24 36 0.6666667 0.4883423 0.7950303
5          exact 24 36 0.6666667 0.4902975 0.8144382
6          logit 24 36 0.6666667 0.5000488 0.7999688
7         probit 24 36 0.6666667 0.5028780 0.8035141
8        profile 24 36 0.6666667 0.5049941 0.8053721
9            lrt 24 36 0.6666667 0.5049938 0.8053855
10     prop.test 24 36 0.6666667 0.4894836 0.8089700
11        wilson 24 36 0.6666667 0.5033400 0.7978538
>  (bc_phenF <- binom.confint(res_phen["FALSE"], sum(res_phen)))
          method  x  n      mean     lower     upper
1  agresti-coull 12 36 0.3333333 0.2013560 0.4974502
2     asymptotic 12 36 0.3333333 0.1793440 0.4873226
3          bayes 12 36 0.3378378 0.1913866 0.4891075
4        cloglog 12 36 0.3333333 0.1877049 0.4860334
5          exact 12 36 0.3333333 0.1855618 0.5097025
6          logit 12 36 0.3333333 0.2000312 0.4999512
7         probit 12 36 0.3333333 0.1964859 0.4971220
8        profile 12 36 0.3333333 0.1946279 0.4950059
9            lrt 12 36 0.3333333 0.1946145 0.4950062
10     prop.test 12 36 0.3333333 0.1910300 0.5105164
11        wilson 12 36 0.3333333 0.2021462 0.4966600
>  binom.test(res_phen["TRUE"], sum(res_phen))

	Exact binomial test

data:  res_phen["TRUE"] and sum(res_phen)
number of successes = 24, number of trials = 36, p-value = 0.06525
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.4902975 0.8144382
sample estimates:
probability of success 
             0.6666667 

> 
>  res_morph <- table(all_slopes_morph$slope.x * all_slopes_morph$slope.y > 0)
>  (bc_morphT <- binom.confint(res_morph["TRUE"], sum(res_morph)))
Warning in stats::prop.test(x[i], n[i]) :
  Chi-squared approximation may be incorrect
          method x n mean     lower     upper
1  agresti-coull 4 8  0.5 0.2152161 0.7847839
2     asymptotic 4 8  0.5 0.1535240 0.8464760
3          bayes 4 8  0.5 0.1989656 0.8010344
4        cloglog 4 8  0.5 0.1520359 0.7748650
5          exact 4 8  0.5 0.1570128 0.8429872
6          logit 4 8  0.5 0.2000625 0.7999375
7         probit 4 8  0.5 0.1925640 0.8074360
8        profile 4 8  0.5 0.1913184 0.8086816
9            lrt 4 8  0.5 0.1912133 0.8087867
10     prop.test 4 8  0.5 0.2152161 0.7847839
11        wilson 4 8  0.5 0.2152161 0.7847839
>  (bc_morphF <- binom.confint(res_morph["FALSE"], sum(res_morph)))
Warning in stats::prop.test(x[i], n[i]) :
  Chi-squared approximation may be incorrect
          method x n mean     lower     upper
1  agresti-coull 4 8  0.5 0.2152161 0.7847839
2     asymptotic 4 8  0.5 0.1535240 0.8464760
3          bayes 4 8  0.5 0.1989656 0.8010344
4        cloglog 4 8  0.5 0.1520359 0.7748650
5          exact 4 8  0.5 0.1570128 0.8429872
6          logit 4 8  0.5 0.2000625 0.7999375
7         probit 4 8  0.5 0.1925640 0.8074360
8        profile 4 8  0.5 0.1913184 0.8086816
9            lrt 4 8  0.5 0.1912133 0.8087867
10     prop.test 4 8  0.5 0.2152161 0.7847839
11        wilson 4 8  0.5 0.2152161 0.7847839
>  binom.test(res_morph["TRUE"], sum(res_morph))

	Exact binomial test

data:  res_morph["TRUE"] and sum(res_morph)
number of successes = 4, number of trials = 8, p-value = 1
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.1570128 0.8429872
sample estimates:
probability of success 
                   0.5 

> 
> 
>  par(par_ini)
>  mat <- matrix(c(1, 2, 3, 3), 2,2, byrow = TRUE)
>  layout(mat, widths =  rep.int(1, ncol(mat)),
+         heights = rep.int(1, nrow(mat)), respect = TRUE)
>  plot_slopes_products(data = merge_3slopes(meta_obj = mod_T_prcs,
+                       meta_obj1 = mod_phen_T_prcs,
+                       meta_obj2 = mod_Sel_T_phen),
+                       phenological = TRUE)
> 
> plot_slopes_products(data = merge_3slopes(meta_obj = mod_T_prcs,
+                      meta_obj1 = mod_morph_T_prcs,
+                      meta_obj2 = mod_Sel_T_morph),
+                      phenological = FALSE, xlim = c(-0.1, 0.1),
+                      ylim = c(-0.1, 0.1))
> 
>  par(par_ini); par(mar = c(4, 8, 3, 6))
>  theplot_Adapt <- barplot(cbind(c(res_phen["TRUE"]/sum(res_phen),
+                                   res_phen["FALSE"]/sum(res_phen)),
+                                     c(res_morph["TRUE"]/sum(res_morph),
+                                       res_morph["FALSE"]/sum(res_morph))),
+                           names.arg = c("Phenology", "Morphology"),
+                           las = 1, ylim = c(0, 1.1),
+                           ylab = "Proportion of studies",
+                           col = c("grey", "black"),
+                           cex.lab = 1.3, cex.axis = 1.3, cex.names = 1.3)
>  legend(x = 0.8, y = 1, horiz = TRUE, fill = c("grey", "black"),
+         legend = c("adaptative", "maladaptive"), bg = 'white')
>  arrows(x0 = theplot_Adapt[1], x1 = theplot_Adapt[1],
+         y0 = bc_phenT[11, "lower"], y1 = bc_phenT[11, "upper"],
+         code = 3, angle = 90, col = "grey30", lwd = 4, length = 0.1)
>  arrows(x0 = theplot_Adapt[2], x1 = theplot_Adapt[2],
+         y0 = bc_morphT[11, "lower"], y1 = bc_morphT[11, "upper"],
+         code = 3, angle = 90, col = "grey30", lwd = 4, length = 0.1)
>  mtext('C)', side = 3, line = 0, adj = 0, cex = 2)
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####         Assess whether responses are adaptive         ####
>  ####                     meta-analysis                     ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  dat_AllTPhen <- prepare_data(data = dat_All, temperature = TRUE,
+                                phenology = TRUE, morphology = FALSE)
>  dat_Adpt <- compute_adaptation(data = dat_AllTPhen)
Extracting info from study 1 ... 
Extracting info from study 7 ... 
Extracting info from study 8 ... 
Extracting info from study 9 ... 
Extracting info from study 10 ... 
Extracting info from study 15 ... 
Extracting info from study 29 ... 
Extracting info from study 30 ... 
Extracting info from study 32 ... 
Extracting info from study 33 ... 
Extracting info from study 34 ... 
Extracting info from study 35 ... 
Extracting info from study 36 ... 
Extracting info from study 37 ... 
Extracting info from study 39 ... 
Extracting info from study 40 ... 
Extracting info from study 41 ... 
Extracting info from study 42 ... 
Extracting info from study 43 ... 
Extracting info from study 49 ... 
Extracting info from study 50 ... 
Extracting info from study 51 ... 
Extracting info from study 52 ... 
Extracting info from study 57 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 58 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 59 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 60 ... 
Extracting info from study 65 ... 
Extracting info from study 66 ... 
Extracting info from study 73 ... 
Extracting info from study 74 ... 
Extracting info from study 75 ... 
Extracting info from study 82 ... 
Extracting info from study 83 ... 
Extracting info from study 86 ... 
Extracting info from study 87 ... 
Extracting info from study 88 ... 
Extracting info from study 92 ... 
Extracting info from study 102 ... 
Warning in .calc_logdisp_cov(object, dvdloglamMat = dvdloglamMat, dvdlogphiMat = dvdlogphiMat,  :
  Numerical precision issue or something else?
   Information matrix for dispersion parameters does not seem positive-definite.
   The prediction variance may be inaccurate.
Extracting info from study 103 ... 
Extracting info from study 108 ... 
Extracting info from study 109 ... 
Extracting info from study 116 ... 
Done!
> 
>  dat_Adpt$slope <- dat_Adpt$WMS * sign(dat_Adpt$prod12)
>  dat_Adpt$SE_slope <- dat_Adpt$se_WMS
> 
>  mod_Adapt_T_Phen <- fit_meta(meta_data = dat_Adpt, fixed = NULL)

 ######################################################### 
 Analysis of  dat_Adpt 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0781; se = 0.07"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.283699  1 0.2572123
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.54e+04 2.83e-05 6.58e+04 0.00e+00 1.48e-06 5.24e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
> 
>  ## morphology
>  dat_AllTMorph <- prepare_data(data = dat_All, temperature = TRUE,
+                                phenology = FALSE, morphology = TRUE)
>  dat_AllTMorph <- dat_AllTMorph[! is.na(dat_AllTMorph$ScaledSE), ]
>  dat_Adpt_Morph <- compute_adaptation(data = dat_AllTMorph)
Extracting info from study 78 ... 
Extracting info from study 81 ... 
Extracting info from study 96 ... 
Extracting info from study 97 ... 
Extracting info from study 98 ... 
Extracting info from study 99 ... 
Extracting info from study 100 ... 
Extracting info from study 101 ... 
Done!
> 
>  dat_Adpt_Morph$slope <- dat_Adpt_Morph$WMS * sign(dat_Adpt_Morph$prod12)
>  dat_Adpt_Morph$SE_slope <- dat_Adpt_Morph$se_WMS
> 
>  mod_Adapt_T_Morph <- fit_meta(meta_data = dat_Adpt_Morph, fixed = NULL)

 ######################################################### 
 Analysis of  dat_Adpt_Morph 
 #########################################################

########### Global slope ###########
[1] "slope = -0.0124; se = 0.0115"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.538064  1 0.2149062
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.67e-01 2.31e+00 4.33e-01 2.08e+01 4.03e-03 1.05e-04 1.38e-04 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  # using selection dataset only: to identify whether the sign
>  # is in the same direction as phenotypic change
>  dat_SelT <- prepare_data(data = dat_Sel, temperature = TRUE,
+                                phenology = TRUE, morphology = FALSE)
>  dat_AllTPhen_Sel <- dat_All[dat_All$id %in% unique(dat_SelT$id), ]
>  dat_Adpt_Sel <- compute_adaptation(data = dat_AllTPhen_Sel)
Extracting info from study 1 ... 
Extracting info from study 7 ... 
Extracting info from study 8 ... 
Extracting info from study 9 ... 
Extracting info from study 10 ... 
Extracting info from study 15 ... 
Extracting info from study 29 ... 
Extracting info from study 30 ... 
Extracting info from study 32 ... 
Extracting info from study 33 ... 
Extracting info from study 34 ... 
Extracting info from study 35 ... 
Extracting info from study 37 ... 
Extracting info from study 39 ... 
Extracting info from study 40 ... 
Extracting info from study 41 ... 
Extracting info from study 42 ... 
Extracting info from study 49 ... 
Extracting info from study 50 ... 
Extracting info from study 51 ... 
Extracting info from study 52 ... 
Extracting info from study 57 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 58 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 59 ... 
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Warning in (function (control.HLfit, ranFix = NULL, HLmethod, predictor,  :
  The variance of the response is low, which may lead to imperfect estimation of variance parameters.
 Perhaps rescale the response?
Extracting info from study 60 ... 
Extracting info from study 65 ... 
Extracting info from study 73 ... 
Extracting info from study 82 ... 
Extracting info from study 86 ... 
Extracting info from study 87 ... 
Extracting info from study 88 ... 
Extracting info from study 92 ... 
Extracting info from study 102 ... 
Warning in .calc_logdisp_cov(object, dvdloglamMat = dvdloglamMat, dvdlogphiMat = dvdlogphiMat,  :
  Numerical precision issue or something else?
   Information matrix for dispersion parameters does not seem positive-definite.
   The prediction variance may be inaccurate.
Extracting info from study 103 ... 
Extracting info from study 108 ... 
Extracting info from study 116 ... 
Done!
> 
>  dat_Adpt_Sel$slope <- dat_Adpt_Sel$WMS * sign(dat_Adpt_Sel$prod12)
>  dat_Adpt_Sel$SE_slope <- dat_Adpt_Sel$se_WMS
> 
>  mod_Adapt_T_Sel <- fit_meta(meta_data = dat_Adpt_Sel, fixed = NULL)

 ######################################################### 
 Analysis of  dat_Adpt_Sel 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0916; se = 0.0726"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.627623  1 0.2020322
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 4.87e+04 2.05e-05 6.51e+04 0.00e+00 1.24e-06 6.02e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Adapt_T_Sel_Sens <- fit_meta(meta_data =
+                                   dat_Adpt_Sel[dat_Adpt_Sel$slope < 0.6, ],
+                                   fixed = NULL)

 ######################################################### 
 Analysis of  [ Analysis of  dat_Adpt_Sel Analysis of  dat_Adpt_Sel$slope < 0.6 Analysis of   
 #########################################################

########### Global slope ###########
[1] "slope = 0.0263; se = 0.036"

########### Global ANOVA ###########
      chi2_LR df   p_value
p_v 0.5648559  1 0.4523103
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 2.12e+04 4.72e-05 6.49e+04 0.00e+00 1.20e-06 2.54e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
>  ## morphology
>  dat_SelT_Morph <- prepare_data(data = dat_Sel, temperature = TRUE,
+                                phenology = FALSE, morphology = TRUE)
>  dat_AllMorph_Sel <- dat_All[dat_All$id %in% unique(dat_SelT_Morph$id), ]
>  dat_AllMorph_Sel <- dat_AllMorph_Sel[! is.na(dat_AllMorph_Sel$ScaledSE), ]
>  dat_Adpt_Morph_Sel <- compute_adaptation(data = dat_AllMorph_Sel)
Extracting info from study 78 ... 
Extracting info from study 81 ... 
Extracting info from study 96 ... 
Extracting info from study 97 ... 
Extracting info from study 98 ... 
Extracting info from study 99 ... 
Extracting info from study 100 ... 
Extracting info from study 101 ... 
Done!
> 
>  dat_Adpt_Morph_Sel$slope <- dat_Adpt_Morph_Sel$WMS *
+                              sign(dat_Adpt_Morph_Sel$prod12)
>  dat_Adpt_Morph_Sel$SE_slope <- dat_Adpt_Morph_Sel$se_WMS
> 
>  mod_Adapt_T_Morph_Sel <- fit_meta(meta_data = dat_Adpt_Morph_Sel, fixed = NULL)

 ######################################################### 
 Analysis of  dat_Adpt_Morph_Sel 
 #########################################################

########### Global slope ###########
[1] "slope = -0.0124; se = 0.0115"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.538064  1 0.2149062
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.67e-01 2.31e+00 4.33e-01 2.08e+01 4.03e-03 1.05e-04 1.38e-04 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  par(par_ini)
>  plot_adapt_T_Sel <- plot_forest(meta_obj1 = mod_Adapt_T_Sel,
+                                  meta_obj2 = mod_Adapt_T_Morph_Sel,
+                                  list_extra_meta_obj =
+                                    list(mod_Adapt_T_Sel, mod_Adapt_T_Morph_Sel),
+                                  sort = c('Species', 'Study_Authors',
+                                           'Fitness_Categ'),
+                                  increasing = TRUE,
+                                  labels = c(traits = TRUE,
+                                             fitness = TRUE,
+                                             country = FALSE,
+                                             authors = FALSE),
+                                  mar = c(7, 10, 2, 2))
Warning in graphics::arrows(x0 = data_plot[i, "lwr"], x1 = data_plot[i,  :
  zero-length arrow is of indeterminate angle and so skipped
> 
>  mtext('the direction of climate-driven', side = 1, line = 4.2, cex = 1.3)
>  mtext('trait change', side = 1, line = 5.3, cex = 1.3)
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####                   Precipitation: Condition 1              ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  ## for PRCS
>  mod_Prec_prcs <- fit_all(data = dat_Clim, temperature = FALSE,
+                           precipitation = TRUE, phenology = TRUE,
+                           morphology = TRUE, condition = '1',
+                           nb_cores = nb_cores, rand_trait = FALSE,
+                           fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==========                                                            |  14%  |                                                                              |====================                                                  |  29%  |                                                                              |==============================                                        |  43%  |                                                                              |========================================                              |  57%  |                                                                              |==================================================                    |  71%  |                                                                              |============================================================          |  86%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.00123; se = 0.0024"

########### Global ANOVA ###########
      chi2_LR df   p_value
p_v 0.2632762  1 0.6078783
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.44e-03 1.00e+00 9.99e-01 5.82e+00 5.60e-01 4.86e-05 7.02e-08 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
>  ## for PRC
>  mod_Prec_prc <- fit_all(data = dat_Clim_prc, temperature = FALSE,
+                          precipitation = TRUE, phenology = TRUE,
+                          morphology = TRUE, condition = '1',
+                          nb_cores = nb_cores, rand_trait = FALSE,
+                          fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  85%  |                                                                              |=============================================================         |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -6.58e-05; se = 0.00135"

########### Global ANOVA ###########
        chi2_LR df   p_value
p_v 0.002369746  1 0.9611743
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.95e-02 1.06e+00 9.40e-01 4.39e+01 6.42e-01 8.55e-05 5.41e-06 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####                Precipitation: Condition 2                 ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  ## for PRCS
>  mod_phen_Prec_prcs <- fit_all(data = dat_Trait, temperature = FALSE,
+                                precipitation = TRUE, phenology = TRUE,
+                                morphology = FALSE, condition = '2',
+                                nb_cores = nb_cores, rand_trait = FALSE,
+                                fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.47; se = 0.33"

########### Global ANOVA ###########
    chi2_LR df  p_value
p_v 2.18812  1 0.139079
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
7.64e-01 4.24e+00 2.36e-01 2.66e+01 8.34e-04 9.07e-02 2.94e-01 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## for PRC
>  mod_phen_Prec_prc <- fit_all(data = dat_Trait_prc, temperature = FALSE,
+                               precipitation = TRUE, phenology = TRUE,
+                               morphology = FALSE, condition = '2',
+                               nb_cores = nb_cores, rand_trait = FALSE,
+                               fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.101; se = 0.31"

########### Global ANOVA ###########
      chi2_LR df   p_value
p_v 0.1374868  1 0.7107924
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
6.26e-01 2.67e+00 3.74e-01 7.58e+02 1.02e-49 4.05e-02 6.76e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_phen_Prec_prc_Taxon <- fit_all(data = dat_Trait_prc,
+                                     temperature = FALSE,
+                                     precipitation = TRUE,
+                                     phenology = TRUE, morphology = FALSE,
+                                     condition = '2', nb_cores = nb_cores,
+                                     rand_trait = FALSE, fixed = 'Taxon',
+                                     digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0716; se = 0.481" "slope = 0.898; se = 1.73"  
[3] "slope = -0.127; se = 1.29"  "slope = 0.108; se = 1.26"  

########### Global ANOVA ###########
Fixed effect of  Taxon 
      chi2_LR df   p_value
p_v 0.4032167  3 0.9395772
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
6.26e-01 2.67e+00 3.74e-01 7.58e+02 1.02e-49 4.05e-02 6.76e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####                  Precipitation: Condition 3               ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ## for phenology, because there is no data on morphological traits
>  ## in the dataset on precipitation
>  mod_Sel_Prec_phen <- fit_all(data = dat_Sel,
+                               temperature = FALSE, precipitation = TRUE,
+                               phenology = TRUE, morphology = FALSE,
+                               condition = '3', nb_cores = nb_cores,
+                               rand_trait = FALSE, fixed = NULL,
+                               digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   9%  |                                                                              |=============                                                         |  18%  |                                                                              |===================                                                   |  27%  |                                                                              |=========================                                             |  36%  |                                                                              |================================                                      |  45%  |                                                                              |======================================                                |  55%  |                                                                              |=============================================                         |  64%  |                                                                              |===================================================                   |  73%  |                                                                              |=========================================================             |  82%  |                                                                              |================================================================      |  91%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.101; se = 0.048"

########### Global ANOVA ###########
     chi2_LR df    p_value
p_v 3.241225  1 0.07180692
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.76e-01 4.21e+01 2.38e-02 4.05e+02 5.29e-80 5.84e-04 2.40e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_Sel_Prec_phen_Fitn <- fit_all(data = dat_Sel, temperature = FALSE,
+                                    precipitation = TRUE, phenology = TRUE,
+                                    morphology = FALSE, condition = '3',
+                                    nb_cores = nb_cores, rand_trait = FALSE,
+                                    fixed = 'Fitness_Categ', digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   9%  |                                                                              |=============                                                         |  18%  |                                                                              |===================                                                   |  27%  |                                                                              |=========================                                             |  36%  |                                                                              |================================                                      |  45%  |                                                                              |======================================                                |  55%  |                                                                              |=============================================                         |  64%  |                                                                              |===================================================                   |  73%  |                                                                              |=========================================================             |  82%  |                                                                              |================================================================      |  91%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.281; se = 0.109"  "slope = -0.162; se = 0.0452"
[3] "slope = 0.0741; se = 0.065" 

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df    p_value
p_v 10.60874  2 0.00496984
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.76e-01 4.21e+01 2.38e-02 4.05e+02 5.29e-80 5.84e-04 2.40e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_Prec_phen_Gener <- fit_all(data = dat_Sel, temperature = FALSE,
+                                     precipitation = TRUE, phenology = TRUE,
+                                     morphology = FALSE, condition = '3',
+                                     nb_cores = nb_cores, rand_trait = FALSE,
+                                     fixed = 'GenerationLength_yr',
+                                     digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   9%  |                                                                              |=============                                                         |  18%  |                                                                              |===================                                                   |  27%  |                                                                              |=========================                                             |  36%  |                                                                              |================================                                      |  45%  |                                                                              |======================================                                |  55%  |                                                                              |=============================================                         |  64%  |                                                                              |===================================================                   |  73%  |                                                                              |=========================================================             |  82%  |                                                                              |================================================================      |  91%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.00777; se = 0.0103"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
     chi2_LR df   p_value
p_v 2.109812  1 0.1463573
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.76e-01 4.21e+01 2.38e-02 4.05e+02 5.29e-80 5.84e-04 2.40e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## supplementary plot of all effects for each condition (as Fig. S3)
>  par(par_ini); par(oma = c(2,1,1,0), mfrow = c(1,3))
> 
>  ## panel a)
>  plot_Prec_Cond1 <- plot_forest(meta_obj1 = mod_Prec_prcs$meta_res,
+                                 meta_obj2 = NULL,
+                                 list_extra_meta_obj =
+                                 list(mod_Prec_prcs$meta_res,
+                                      mod_Prec_prc$meta_res),
+                                 sort = c("Coord"),
+                                 increasing = FALSE,
+                                 labels = c(traits = FALSE,
+                                            fitness = FALSE,
+                                            country = TRUE,
+                                            authors = FALSE),
+                                 mar = c(4, 9, 2, 2))
>  mtext('Across', side = 2, line = 5,
+        at = -1.2, las = 2, cex = 0.9, col = 'black')
>  mtext('studies', side = 2, line = 5,
+        at = -1.8, las = 2, cex = 0.9, col = 'black')
>  mtext('a)', side = 2, at = 11.1, cex = 1.5, las = 2, line = 1)
> 
>  ## panel b)
>  plot_Prec_Trait_Cond2 <- plot_forest(meta_obj1 = mod_phen_Prec_prcs$meta_res,
+                          meta_obj2 = NULL,
+                          list_extra_meta_obj =
+                          list(mod_phen_Prec_prcs$meta_res,
+                               mod_phen_Prec_prc$meta_res),
+                          sort = c('Species', 'Trait_Categ_det'),
+                          increasing = FALSE,
+                          labels = c(traits = TRUE,
+                                     fitness = FALSE,
+                                     country = FALSE,
+                                     authors = FALSE),
+                          mar = c(4, 9, 2, 2))
>  mtext('Across', side = 2, line = 6,
+        at = -1.2, las = 2, cex = 0.8, col = 'black')
>  mtext('studies', side = 2, line = 6,
+        at = -1.8, las = 2, cex = 0.8, col = 'black')
>  mtext('b)', side = 2, at = 12.3, cex = 1.5, las = 2, line = 1.2)
> 
>  ## panel c)
>  plot_Sel_Prec_cond3 <- plot_forest(meta_obj1 = mod_Sel_Prec_phen$meta_res,
+                          meta_obj2 = NULL,
+                          list_extra_meta_obj =
+                          list(mod_Sel_Prec_phen$meta_res,
+                               mod_Sel_Prec_phen_Fitn$meta_res),
+                          sort = c('Species', 'Study_Authors',
+                                   'Fitness_Categ'),
+                          increasing = FALSE,
+                          labels = c(traits = TRUE,
+                                     fitness = TRUE,
+                                     country = FALSE,
+                                     authors = FALSE),
+                          mar = c(4, 13, 2, 2))
>  mtext('Across', side = 2, line = 8,
+        at = -2, las = 2, cex = 0.8, col = 'black')
>  mtext('studies', side = 2, line = 8,
+        at = -3, las = 2, cex = 0.8, col = 'black')
>  mtext('c)', side = 2, at = 13.3, cex = 1.5, las = 2, line = 1.2)
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####                      Sensitivity analysis                           ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  ## excluding the study by Goodenough et al. (2011)
>  mod_phen_T_prcs_noOutlier <- fit_all(data = dat_Trait[
+                               dat_Trait$Study_Authors != 'Goodenough', ],
+                               temperature = TRUE, precipitation = FALSE,
+                               phenology = TRUE, morphology = FALSE,
+                               condition = '2', nb_cores = nb_cores,
+                               rand_trait = FALSE, fixed = NULL,
+                               digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  19%  |                                                                              |================                                                      |  22%  |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  28%  |                                                                              |=====================                                                 |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  39%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |===========================================                           |  61%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  69%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  81%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.231; se = 0.0604"

########### Global ANOVA ###########
     chi2_LR df     p_value
p_v 10.13441  1 0.001455268
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.04e-01 1.04e+01 9.65e-02 2.86e+02 9.48e-41 6.84e-03 6.40e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## selection
>  mod_Sel_T_phen_noOutlier <- fit_all(data = dat_Sel[
+                              dat_Sel$Study_Authors != 'Goodenough', ],
+                              temperature = TRUE, precipitation = FALSE,
+                              phenology = TRUE, morphology = FALSE,
+                              condition = '3', nb_cores = nb_cores,
+                              rand_trait = FALSE, fixed = NULL,
+                              digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.113; se = 0.0244"

########### Global ANOVA ###########
     chi2_LR df     p_value
p_v 12.78748  1 0.000348947
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 1.03e+04 9.66e-05 5.08e+04 0.00e+00 1.20e-06 1.24e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_Sel_T_phen_Fitn_noOutlier <- fit_all(data = dat_Sel[
+                                   dat_Sel$Study_Authors != 'Goodenough', ],
+                                   temperature = TRUE, precipitation = FALSE,
+                                   phenology = TRUE, morphology = FALSE,
+                                   condition = '3', nb_cores = nb_cores,
+                                   rand_trait = FALSE, fixed = 'Fitness_Categ',
+                                   digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.18; se = 0.0368"  "slope = -0.0912; se = 0.03" 
[3] "slope = -0.032; se = 0.0492"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df    p_value
p_v 7.005568  2 0.03011344
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 1.03e+04 9.66e-05 5.08e+04 0.00e+00 1.20e-06 1.24e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_T_phen_Gener_noOutlier <- fit_all(data = dat_Sel[
+                                    dat_Sel$Study_Authors != 'Goodenough', ],
+                                    temperature = TRUE, precipitation = FALSE,
+                                    phenology = TRUE, morphology = FALSE,
+                                    condition = '3', nb_cores = nb_cores,
+                                    rand_trait = FALSE,
+                                    fixed = 'GenerationLength_yr',
+                                    digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.0138; se = 0.0049"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
     chi2_LR df  p_value
p_v 0.399006  1 0.527603
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 1.03e+04 9.66e-05 5.08e+04 0.00e+00 1.20e-06 1.24e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## excluding the study on mammal
>  mod_phen_T_prcs_noMammal <- fit_all(data = dat_Trait[
+                              dat_Trait$Study_Authors != 'Plard_et_al', ],
+                              temperature = TRUE, precipitation = FALSE,
+                              phenology = TRUE, morphology = FALSE,
+                              condition = '2', nb_cores = nb_cores,
+                              rand_trait = FALSE, fixed = NULL,
+                              digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  19%  |                                                                              |================                                                      |  22%  |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  28%  |                                                                              |=====================                                                 |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  39%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |===========================================                           |  61%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  69%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  81%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.265; se = 0.0651"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 11.73253  1 0.0006141711
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.04e-01 1.05e+01 9.56e-02 2.82e+02 6.95e-40 6.92e-03 6.55e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## phenology
>  mod_Sel_T_phen_noMammal <- fit_all(data = dat_Sel[
+                             dat_Sel$Study_Authors != 'Plard_et_al', ],
+                             temperature = TRUE, precipitation = FALSE,
+                             phenology = TRUE, morphology = FALSE,
+                             condition = '3', nb_cores = nb_cores,
+                             rand_trait = FALSE, fixed = NULL,
+                             digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.167; se = 0.0699"

########### Global ANOVA ###########
     chi2_LR df    p_value
p_v 5.176542  1 0.02289384
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 2.00e+03 5.00e-04 2.28e+04 0.00e+00 2.16e-05 4.31e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_Sel_T_phen_Fitn_noMammal <- fit_all(data = dat_Sel[
+                                  dat_Sel$Study_Authors != 'Plard_et_al', ],
+                                  temperature = TRUE, precipitation = FALSE,
+                                  phenology = TRUE, morphology = FALSE,
+                                  condition = '3', nb_cores = nb_cores,
+                                  rand_trait = FALSE, fixed = 'Fitness_Categ',
+                                  digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.233; se = 0.0843"  "slope = -0.153; se = 0.0732" 
[3] "slope = -0.0823; se = 0.0973"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df   p_value
p_v 3.548608  2 0.1696015
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 2.00e+03 5.00e-04 2.28e+04 0.00e+00 2.16e-05 4.31e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_T_phen_Gener_noMammal <- fit_all(data = dat_Sel[
+                                   dat_Sel$Study_Authors != 'Plard_et_al', ],
+                                   temperature = TRUE, precipitation = FALSE,
+                                   phenology = TRUE, morphology = FALSE,
+                                   condition = '3', nb_cores = nb_cores,
+                                   rand_trait = FALSE,
+                                   fixed = 'GenerationLength_yr',
+                                   digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  15%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  24%  |                                                                              |===================                                                   |  26%  |                                                                              |=====================                                                 |  29%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |=============================                                         |  41%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  59%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  74%  |                                                                              |======================================================                |  76%  |                                                                              |========================================================              |  79%  |                                                                              |==========================================================            |  82%  |                                                                              |============================================================          |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.0188; se = 0.0115"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
      chi2_LR df   p_value
p_v 0.3965362  1 0.5288836
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 2.00e+03 5.00e-04 2.28e+04 0.00e+00 2.16e-05 4.31e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## excluding both the study on mammal and the study by Goodenough et al. (2011)
>  mod_phen_T_prcs_noBoth <- fit_all(data = dat_Trait[!
+                              dat_Trait$Study_Authors %in%
+                              c('Goodenough', 'Plard_et_al'), ],
+                              temperature = TRUE, precipitation = FALSE,
+                              phenology = TRUE, morphology = FALSE,
+                              condition = '2', nb_cores = nb_cores,
+                              rand_trait = FALSE, fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.246; se = 0.0616"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 10.83575  1 0.0009955897
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.03e-01 1.03e+01 9.67e-02 2.76e+02 3.32e-39 6.73e-03 6.29e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  mod_Sel_T_phen_noBoth <- fit_all(data = dat_Sel[!
+                                   dat_Sel$Study_Authors %in%
+                                   c('Goodenough', 'Plard_et_al'), ],
+                                   temperature = TRUE, precipitation = FALSE,
+                                   phenology = TRUE, morphology = FALSE,
+                                   condition = '3', nb_cores = nb_cores,
+                                   rand_trait = FALSE, fixed = NULL,
+                                   digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |===========                                                           |  15%  |                                                                              |=============                                                         |  18%  |                                                                              |===============                                                       |  21%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |============================                                          |  39%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  45%  |                                                                              |==================================                                    |  48%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  55%  |                                                                              |========================================                              |  58%  |                                                                              |==========================================                            |  61%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  79%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.111; se = 0.0257"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 11.36001  1 0.0007504222
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.98e-01 6.20e+02 1.61e-03 2.27e+04 0.00e+00 2.09e-05 1.30e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## fixed effects
>  mod_Sel_T_phen_Fitn_noBoth <- fit_all(data = dat_Sel[!
+                                  dat_Sel$Study_Authors %in%
+                                  c('Goodenough', 'Plard_et_al'), ],
+                                  temperature = TRUE, precipitation = FALSE,
+                                  phenology = TRUE, morphology = FALSE,
+                                  condition = '3', nb_cores = nb_cores,
+                                  rand_trait = FALSE, fixed = 'Fitness_Categ',
+                                  digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |===========                                                           |  15%  |                                                                              |=============                                                         |  18%  |                                                                              |===============                                                       |  21%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |============================                                          |  39%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  45%  |                                                                              |==================================                                    |  48%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  55%  |                                                                              |========================================                              |  58%  |                                                                              |==========================================                            |  61%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  79%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.176; se = 0.0363"  "slope = -0.089; se = 0.0297" 
[3] "slope = 0.00133; se = 0.0561"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df    p_value
p_v 8.283406  2 0.01589576
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.98e-01 6.20e+02 1.61e-03 2.27e+04 0.00e+00 2.09e-05 1.30e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> mod_Sel_T_phen_Gener_noBoth <- fit_all(data = dat_Sel[!
+                                    dat_Sel$Study_Authors %in%
+                                    c('Goodenough', 'Plard_et_al'), ],
+                                    temperature = TRUE, precipitation = FALSE,
+                                    phenology = TRUE, morphology = FALSE,
+                                    condition = '3', nb_cores = nb_cores,
+                                    rand_trait = FALSE,
+                                    fixed = 'GenerationLength_yr',
+                                    digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  12%  |                                                                              |===========                                                           |  15%  |                                                                              |=============                                                         |  18%  |                                                                              |===============                                                       |  21%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |============================                                          |  39%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  45%  |                                                                              |==================================                                    |  48%  |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  55%  |                                                                              |========================================                              |  58%  |                                                                              |==========================================                            |  61%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  79%  |                                                                              |=========================================================             |  82%  |                                                                              |===========================================================           |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.0134; se = 0.00496"

########### Global ANOVA ###########
Fixed effect of  GenerationLength_yr 
      chi2_LR df   p_value
p_v 0.3396597  1 0.5600257
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.98e-01 6.20e+02 1.61e-03 2.27e+04 0.00e+00 2.09e-05 1.30e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####              Sensitivity to the inclusion of abundance             ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  dat_PhenT_ab <- prepare_data(data = dat_Trait, temperature = TRUE,
+                               precipitation = FALSE, phenology = TRUE,
+                               morphology = FALSE)
>  dat_PhenT_ab <- dat_PhenT_ab[! is.na(dat_PhenT_ab$ScaledPop), ]
> 
>  # to exclude studies with < 11 years
>  num_years <- dat_PhenT_ab %>%
+               dplyr::group_by(., id) %>%
+               dplyr::summarise(num = dplyr::n())
> 
>  num_years <- num_years[num_years$num > 10, ]
>  dat_PhenT_ab <- dat_PhenT_ab[dat_PhenT_ab$id %in% num_years$id, ]
> 
>  EfSizes_phen_ab <- extract_effects_all_ids(data = dat_PhenT_ab, condition = '2b',
+                                            nb_cores = nb_cores)
  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |=====                                                                 |   8%  |                                                                              |========                                                              |  12%  |                                                                              |===========                                                           |  15%  |                                                                              |=============                                                         |  19%  |                                                                              |================                                                      |  23%  |                                                                              |===================                                                   |  27%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  46%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  58%  |                                                                              |===========================================                           |  62%  |                                                                              |==============================================                        |  65%  |                                                                              |================================================                      |  69%  |                                                                              |===================================================                   |  73%  |                                                                              |======================================================                |  77%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |=================================================================     |  92%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%>  EfSizes_phen_ab$slope <- EfSizes_phen_ab$slope_clim
>  EfSizes_phen_ab$SE_slope <- EfSizes_phen_ab$se_slope_clim
>  meta_phen_abund <- fit_meta(EfSizes_phen_ab, fixed = NULL,
+                             rand_trait = FALSE, digit = 3)

 ######################################################### 
 Analysis of  EfSizes_phen_ab 
 #########################################################

########### Global slope ###########
[1] "slope = -0.293; se = 0.09"

########### Global ANOVA ###########
    chi2_LR df    p_value
p_v  7.5571  1 0.00597741
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.43e-01 1.74e+01 5.73e-02 2.75e+02 2.00e-43 4.97e-03 8.17e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
>  ## and a model without abundance on this subset of data
>  mod_phen_T_prcs_subs <- fit_all(data = dat_PhenT_ab, temperature = TRUE,
+                                  precipitation = FALSE, phenology = TRUE,
+                                  morphology = FALSE, condition = '2',
+                                  nb_cores = nb_cores, rand_trait = FALSE,
+                                  fixed = NULL, digit = digit)
  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |=====                                                                 |   8%  |                                                                              |========                                                              |  12%  |                                                                              |===========                                                           |  15%  |                                                                              |=============                                                         |  19%  |                                                                              |================                                                      |  23%  |                                                                              |===================                                                   |  27%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  38%  |                                                                              |==============================                                        |  42%  |                                                                              |================================                                      |  46%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  58%  |                                                                              |===========================================                           |  62%  |                                                                              |==============================================                        |  65%  |                                                                              |================================================                      |  69%  |                                                                              |===================================================                   |  73%  |                                                                              |======================================================                |  77%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  85%  |                                                                              |==============================================================        |  88%  |                                                                              |=================================================================     |  92%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.29; se = 0.0735"

########### Global ANOVA ###########
    chi2_LR df     p_value
p_v 8.97741  1 0.002733378
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.18e-01 1.22e+01 8.20e-02 2.19e+02 1.67e-32 6.38e-03 7.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
>  ## plot as Supplementary Fig. S14 (for all slopes)
>  par(par_ini)
>  plot_abund_effects(meta_data = EfSizes_phen_ab)
> 
> 
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####               Supplementary: Funnel plots                          ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  ## funnel plots for PRCS, as Supplementary Fig. S16
>  par(par_ini); par(mfrow = c(2, 3))
>  plot_funnel(meta_obj = mod_T_prcs)
>  mtext('a)', line = 1, adj = 0, cex = 1.7)
> 
>  plot_funnel(meta_obj = mod_phen_T_prcs)
>  mtext('b)', line = 1, adj = 0, cex = 1.7)
> 
>  plot_funnel(meta_obj = mod_morph_T_prcs)
>  mtext('c)', line = 1, adj = 0, cex = 1.7)
> 
>  plot_funnel(meta_obj = mod_Sel_T_phen, model = 'lm')
>  mtext('d)', line = 1, adj = 0, cex = 1.7)
> 
>  plot_funnel(meta_obj = mod_Sel_T_morph)
>  mtext('e)', line = 1, adj = 0, cex = 1.7)
> 
> 
>  ## funnel plots for PRC, as Supplementary Fig. S17
>  ## run only if the models were fit
>  ## Not run: 
> ##D    par(par_ini); par(mfrow = c(1,3))
> ##D 
> ##D    plot_funnel(meta_obj = mod_T_prc)
> ##D    mtext('a)', line = 1, adj = 0, cex = 1.7)
> ##D 
> ##D    plot_funnel(meta_obj = mod_phen_T_prc)
> ##D    mtext('b)', line = 1, adj = 0, cex = 1.7)
> ##D 
> ##D    plot_funnel(meta_obj = mod_morph_T_prc)
> ##D    mtext('c)', line = 1, adj = 0, cex = 1.7)
> ## End(Not run)
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####           Supplementary: temperature over years VS                ####
>  ####                    study duration VS first year                   ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  ## make sure the model is fitted before running this model
>  ## Not run: 
> ##D    plot_eff_dur_firstY(data = dat_Clim_prc, meta_obj = mod_T_prc)
> ##D  
> ## End(Not run)
> 
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
>  ####              Prepare Supplementary Tables                          ####
>  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
> 
>  # a list of models
>  # can only be run if all the models were fitted,
>  # some of which are time-consuming to fit
>  ## Not run: 
> ##D    mod_list <- list(mod_T_prcs, mod_phen_T_prcs, mod_phen_T_prcs_Type,
> ##D                   mod_morph_T_prcs, mod_morph_T_prcs_Type, mod_Sel_T_phen,
> ##D                   mod_Sel_T_phen_Fitn, mod_Sel_T_phen_Gener, mod_Sel_T_morph,
> ##D                   mod_Sel_T_morph_Fitn, mod_Sel_T_morph_Gener, mod_Prec_prcs,
> ##D                   mod_phen_Prec_prcs, mod_Sel_Prec_phen, mod_Sel_Prec_phen_Fitn,
> ##D                   mod_Sel_Prec_phen_Gener, mod_T_prc, mod_phen_T_prc,
> ##D                   mod_phen_T_prc_Taxon, mod_phen_T_prc_Type, mod_morph_T_prc,
> ##D                   mod_morph_T_prc_Taxon, mod_morph_T_prc_Type,
> ##D                   mod_morph_T_prc_Therm, mod_Prec_prc, mod_phen_Prec_prc,
> ##D                   mod_phen_Prec_prc_Taxon)
> ##D 
> ##D    ## A table with the effect sizes and their SE
> ##D    tab_efSizes_ST1(model_list = mod_list)
> ##D 
> ##D    ## A table with LRT statistics
> ##D    tab_LRT_ST2(model_list = mod_list)
> ##D  
> ## End(Not run)
>  # a list of models
>  mod_list_sens <- list(mod_phen_T_prcs_noOutlier,
+                        mod_Sel_T_phen_noOutlier,
+                        mod_Sel_T_phen_Fitn_noOutlier,
+                        mod_Sel_T_phen_Gener_noOutlier,
+                        mod_phen_T_prcs_noMammal,
+                        mod_Sel_T_phen_noMammal,
+                        mod_Sel_T_phen_Fitn_noMammal,
+                        mod_Sel_T_phen_Gener_noMammal,
+                        mod_phen_T_prcs_noBoth,
+                        mod_Sel_T_phen_noBoth,
+                        mod_Sel_T_phen_Fitn_noBoth,
+                        mod_Sel_T_phen_Gener_noBoth)
> 
>  tab_efSizes_ST4(model_list = mod_list_sens)
                                                                                          Excluding
1                                                    The study by Goodenough et al. (2011), outlier
2                                                                                                  
3                                                                                                  
4                                                                                                  
5                                                                                                  
6                                                                                                  
7                                                      The only study on mammal (Plard et al. 2014)
8                                                                                                  
9                                                                                                  
10                                                                                                 
11                                                                                                 
12                                                                                                 
13 Both the only study on mammal (Plard et al. 2014) and the outlier study (Goodenough et al. 2011)
14                                                                                                 
15                                                                                                 
16                                                                                                 
17                                                                                                 
18                                                                                                 
                                                                                   Response
1                                               Slope of phenological traits on temperature
2  Mean selection across phenological traits separately (presumably induced by temperature)
3                                                                                          
4                                                                                          
5                                                                                          
6                                                                                          
7                                               Slope of phenological traits on temperature
8  Mean selection across phenological traits separately (presumably induced by temperature)
9                                                                                          
10                                                                                         
11                                                                                         
12                                                                                         
13                                              Slope of phenological traits on temperature
14 Mean selection across phenological traits separately (presumably induced by temperature)
15                                                                                         
16                                                                                         
17                                                                                         
18                                                                                         
              Effect     Modality     Estimate          SE
1          Intercept              -0.230783763 0.060422380
2          Intercept              -0.112632479 0.024354212
3  Fitness component  Recruitment -0.179901270 0.036846609
4                    Reproduction -0.091236788 0.030001905
5                        Survival -0.031977704 0.049165870
6  Generation length              -0.013751578 0.004895992
7          Intercept              -0.264924253 0.065122321
8          Intercept              -0.167218421 0.069891485
9  Fitness component  Recruitment -0.233144149 0.084334539
10                   Reproduction -0.153424561 0.073189073
11                       Survival -0.082304168 0.097314016
12 Generation length              -0.018771650 0.011524902
13         Intercept              -0.246352823 0.061559277
14         Intercept              -0.111117842 0.025705974
15 Fitness component  Recruitment -0.176404680 0.036263509
16                   Reproduction -0.089045081 0.029714596
17                       Survival  0.001331214 0.056056085
18 Generation length              -0.013410745 0.004957929
> 
>  ## a table for the LRT statistics and the variation due to random effects
>  ## for the sensitivity analysis
>  tab_LRT_ST5(model_list = mod_list_sens)
                                                                                          Excluding
1                                                    The study by Goodenough et al. (2011), outlier
2                                                                                                  
3                                                                                                  
4                                                                                                  
5                                                      The only study on mammal (Plard et al. 2014)
6                                                                                                  
7                                                                                                  
8                                                                                                  
9  Both the only study on mammal (Plard et al. 2014) and the outlier study (Goodenough et al. 2011)
10                                                                                                 
11                                                                                                 
12                                                                                                 
                                                                                   Response
1                                               Slope of phenological traits on temperature
2  Mean selection across phenological traits separately (presumably induced by temperature)
3                                                                                          
4                                                                                          
5                                               Slope of phenological traits on temperature
6  Mean selection across phenological traits separately (presumably induced by temperature)
7                                                                                          
8                                                                                          
9                                               Slope of phenological traits on temperature
10 Mean selection across phenological traits separately (presumably induced by temperature)
11                                                                                         
12                                                                                         
              Effect        LRT df p value Random variance due to study ID
1          Intercept 10.1344100  1  0.0015                     0.053523607
2          Intercept 12.7874792  1  0.0003                     0.009180769
3  Fitness component  7.0055676  2  0.0301                     0.006149566
4  Generation length  0.3990060  1  0.5276                     0.008665323
5          Intercept 11.7325278  1  0.0006                     0.052017688
6          Intercept  5.1765424  1  0.0229                     0.009113526
7  Fitness component  3.5486077  2  0.1696                     0.008063485
8  Generation length  0.3965362  1  0.5289                     0.009050866
9          Intercept 10.8357502  1  0.0010                     0.052307772
10         Intercept 11.3600149  1  0.0008                     0.009410333
11 Fitness component  8.2834055  2  0.0159                     0.006291373
12 Generation length  0.3396597  1  0.5600                     0.008680600
   Random variance due to publication ID
1                            0.015942702
2                            0.003131387
3                            0.004155027
4                            0.008531740
5                            0.022289714
6                            0.070027743
7                            0.070872197
8                            0.085125474
9                            0.016112130
10                           0.003507171
11                           0.003728022
12                           0.008836906
> 
>  ## a table for heterogeneity
>  ## make sure all models are fitted before running this
>  ## Not run: 
> ##D   mod_heterogen <- list(mod_T_prcs, mod_phen_T_prcs, mod_morph_T_prcs,
> ##D                         mod_Sel_T_phen, mod_Sel_T_morph, mod_Prec_prcs,
> ##D                         mod_phen_Prec_prcs, mod_Sel_Prec_phen, mod_T_prc,
> ##D                         mod_phen_T_prc, mod_morph_T_prc, mod_Prec_prc,
> ##D                         mod_phen_Prec_prc, mod_phen_T_prcs_noOutlier,
> ##D                         mod_Sel_T_phen_noOutlier, mod_phen_T_prcs_noMammal,
> ##D                         mod_Sel_T_phen_noMammal, mod_phen_T_prcs_noBoth,
> ##D                         mod_Sel_T_phen_noBoth)
> ##D   tab_heterog(model_list = mod_heterogen,)
> ##D  
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("adRes-package", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("compute_WMS")
> ### * compute_WMS
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: compute_WMS
> ### Title: Compute the Weighted Mean Selection (WMS) gradient
> ### Aliases: compute_WMS
> 
> ### ** Examples
> 
> data_for_Trait <- prepare_data(data = dat_Trait, temperature = TRUE,
+                                phenology = TRUE, morphology = FALSE)
> mod3 <- fit_cond_id(data = data_for_Trait, id = "82", condition = "3")
> compute_WMS(mod_sel = mod3)
$WMS
[1] -0.01025986

$se
[1] 0.008640196

> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("compute_WMS", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("compute_adaptation")
> ### * compute_adaptation
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: compute_adaptation
> ### Title: Compute the necessary information for testing adaptation
> ### Aliases: compute_adaptation
> 
> ### ** Examples
> 
> data_for_Trait <- prepare_data(data = dat_Trait, temperature = TRUE,
+                                phenology = TRUE, morphology = FALSE)
> compute_adaptation(data = data_for_Trait[data_for_Trait$id %in% c("7"), ])
Extracting info from study 7 ... 
Done!
  id Study_Authors             Species Trait_Categ_det  Trait_Categ Trait_Cat
7  7 Porlier_et_al Cyanistes caeruleus Egg_laying_date Phenological  Breeding
  Fitness_Categ Country_code PaperID Taxon                 Location
7   Recruitment           FR      18  Aves Evergreen-Pirio, Corsica
                    CH    CH_Categ             Trait Morph_type Blood Npoints
7 MeanAprilTemperature Temperature MeanEggLayingDate       <NA>  Warm      30
  data     AR1cor       LRT.p LRT.Chi2   min_phi     lambda condition
7 PRCS -0.3045276 0.004684305 7.997459 0.8627884 0.08938393         3
       slope SE_slope Coord_Lat_deg Coord_Lat_min Coord GenerationLength_yr
7 -0.2241165  0.02653            42            24  2544                 4.4
        prod12   se_prod12        WMS  se_WMS
7 -0.005303475 0.005827421 -0.2241165 0.02653
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("compute_adaptation", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("extract_effects")
> ### * extract_effects
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: extract_effects
> ### Title: Extract the effect sizes and their standard errors from the
> ###   model fitted to a single study
> ### Aliases: extract_effects
> 
> ### ** Examples
> 
> dat_clim <- prepare_data(data = dat_Clim, temperature = TRUE,
+                          precipitation = FALSE,
+                          phenology = TRUE, morphology = TRUE)
> 
> fitted_mod <- fit_cond_id(data = dat_clim, id = '30', condition = '1')
> test <- extract_effects(fitted_mod)
> 
> 
> dat_sel_phen <- prepare_data(data = dat_Sel, temperature = TRUE,
+                              precipitation = FALSE,
+                              phenology = TRUE, morphology = FALSE)
> 
> test_sel_phen <- extract_effects(fit_cond_id(data = dat_sel_phen,
+                                  id  = '1', condition = '3'))
> 
> dat_phen_prcs <- prepare_data(data = dat_Trait, temperature = TRUE,
+                               precipitation = FALSE,
+                               phenology = TRUE, morphology = FALSE)
> mod_phen_abund <- fit_cond_id(data = dat_phen_prcs, id  = '1', condition = '2b')
> test_tr_phen_abund <- extract_effects(mod_phen_abund)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("extract_effects", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("extract_effects_all_ids")
> ### * extract_effects_all_ids
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: extract_effects_all_ids
> ### Title: Fit model on each study, for a given condition, and extract the
> ###   effect sizes and their standard errors
> ### Aliases: extract_effects_all_ids
> 
> ### ** Examples
> 
> ## Not run: 
> ##D nb_cores <- 2L ## increase the number for using more cores
> ##D dat_clim <- prepare_data(data = dat_Clim, temperature = TRUE,
> ##D                          precipitation = FALSE,
> ##D                          phenology = TRUE, morphology = TRUE)
> ##D test <- extract_effects_all_ids(data = dat_clim,
> ##D                                 condition = "1", nb_cores = nb_cores)
> ##D head(test)
> ##D 
> ##D dat_sel_phen <- prepare_data(data = dat_Sel, temperature = TRUE,
> ##D                              precipitation = FALSE,
> ##D                              phenology = TRUE, morphology = FALSE)
> ##D test_sel <- extract_effects_all_ids(data = dat_sel_phen,
> ##D                                     condition = "3", nb_cores = nb_cores)
> ##D 
> ##D 
> ##D dat_T_Trait <- prepare_data(data = dat_Trait, temperature = TRUE,
> ##D                             precipitation = FALSE,
> ##D                             phenology = TRUE, morphology = FALSE)
> ##D test_Trait <- extract_effects_all_ids(data = dat_T_Trait,
> ##D                                       condition = "2", nb_cores = nb_cores)
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("extract_effects_all_ids", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fit_all")
> ### * fit_all
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fit_all
> ### Title: Get global effect size and its standard error as well as effect
> ###   sizes for all studies for a particular condition
> ### Aliases: fit_all
> 
> ### ** Examples
> 
> nb_cores <- 2L ## increase the number for using more cores
> meta_Sel_phen <- fit_all(data = dat_Sel, temperature = TRUE,
+                          precipitation = FALSE,
+                          phenology = TRUE, morphology = FALSE,
+                          condition = '3', nb_cores = nb_cores,
+                          rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.165; se = 0.0652"

########### Global ANOVA ###########
     chi2_LR df    p_value
p_v 5.718049  1 0.01679138
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> meta_Sel_morph <- fit_all(data = dat_Sel,
+                          temperature = TRUE, precipitation = FALSE,
+                          phenology = FALSE, morphology = TRUE,
+                          condition = '3', nb_cores = nb_cores,
+                          rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.056; se = 0.0599"

########### Global ANOVA ###########
     chi2_LR df   p_value
p_v 1.093157  1 0.2957728
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.73e-01 3.64e+01 2.75e-02 1.16e+02 1.95e-21 1.07e-04 3.81e-03 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> meta_Sel_phen_Fitn <- fit_all(data = dat_Sel,
+                               temperature = TRUE, precipitation = FALSE,
+                               phenology = TRUE, morphology = FALSE,
+                               condition = '3', nb_cores = nb_cores,
+                               rand_trait = FALSE,
+                               fixed = 'Fitness_Categ', digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.235; se = 0.0806"  "slope = -0.156; se = 0.0695" 
[3] "slope = -0.0871; se = 0.0899"

########### Global ANOVA ###########
Fixed effect of  Fitness_Categ 
     chi2_LR df   p_value
p_v 3.534851  2 0.1707721
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fit_all", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fit_cond_id")
> ### * fit_cond_id
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fit_cond_id
> ### Title: Fit a single mixed-effects model to test a given condition for a
> ###   given study id
> ### Aliases: fit_cond_id
> 
> ### ** Examples
> 
> 
> dat_trials <- prepare_data(data = dat_Clim,
+                            temperature = TRUE, precipitation = FALSE,
+                            phenology = TRUE, morphology = TRUE)
> test <- fit_cond_id(data = dat_trials, id = '1', condition = '1')
> 
> dat_temp_phen <- prepare_data(data = dat_Trait,
+                            temperature = TRUE, precipitation = FALSE,
+                            phenology = TRUE, morphology = FALSE)
> test_trait <- fit_cond_id(data = dat_temp_phen, id = '1', condition = '2')
> test_trait$model
formula: ScaledTrait ~ Clim + year + AR1(1 | year)
REML: Estimation of lambda, phi and corrPars by REML.
      Estimation of fixed effects by ML.
Family: gaussian ( link = identity ) 
 ------------ Fixed effects (beta) ------------
            Estimate  Cond. SE t-value
(Intercept) 37.34533 10.683005   3.496
Clim        -0.62194  0.071531  -8.695
year        -0.01527  0.005622  -2.717
 --------------- Random effects ---------------
Family: gaussian ( link = identity ) 
                   --- Correlation parameters:
   1.ARphi 
-0.3159346 
           --- Variance parameters ('lambda'):
lambda = var(u) for u ~ Gaussian; 
   year  :  0.2701  
             --- Coefficients for log(lambda):
 Group        Term Estimate Cond.SE
  year (Intercept)   -1.309  0.2209
# of obs: 44; # of groups: year, 44 
 ------------- Residual variance  -------------
Prior weights: 257.702 181.035 171.439 121.059 105.217 ...
Coefficients for log(phi)  ~ 1  :
            Estimate Cond. SE
(Intercept)   -12.76    677.3
Estimate of phi=residual var:  2.873e-06 
 ------------- Likelihood values  -------------
                        logLik
p_v(h) (marginal L): -29.87215
  p_beta,v(h) (ReL): -38.02003
> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fit_cond_id", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fit_meta")
> ### * fit_meta
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fit_meta
> ### Title: Fit a meta-analytical model to extract global effect sizes
> ###   across studies
> ### Aliases: fit_meta
> 
> ### ** Examples
> 
> ## Not run: 
> ##D nb_cores <- 2L ## increase the number for using more cores
> ##D dat_sel_phen <- prepare_data(data = dat_Sel,
> ##D                              temperature = TRUE, precipitation = FALSE,
> ##D                              phenology = TRUE, morphology = FALSE)
> ##D test_sel <- extract_effects_all_ids(data = dat_sel_phen,
> ##D                                     condition = '3', nb_cores = nb_cores)
> ##D test_meta_sel <- fit_meta(test_sel)
> ##D test_meta_sel_Fitn <- fit_meta(test_sel, fixed = 'Fitness_Categ')
> ##D 
> ##D 
> ##D dat_T_phen <- prepare_data(data = dat_Trait,
> ##D                            temperature = TRUE, precipitation = FALSE,
> ##D                            phenology = TRUE, morphology = FALSE)
> ##D test_T_phen <- extract_effects_all_ids(data = dat_T_phen,
> ##D                                       condition = '2', nb_cores = nb_cores)
> ##D test_meta_T_phen <- fit_meta(test_T_phen)
> ##D test_meta_T_phen_Taxon <- fit_meta(test_T_phen, fixed = 'Taxon')
> ## End(Not run)
> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fit_meta", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fit_model")
> ### * fit_model
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fit_model
> ### Title: Fit the model for a given study id
> ### Aliases: fit_model
> 
> ### ** Examples
> 
> dat_trials <- prepare_data(data = dat_Clim,
+                            temperature = TRUE, precipitation = FALSE,
+                            phenology = TRUE, morphology = TRUE)
> 
> test <- fit_model(data = dat_trials,
+                   formula_full = 'Clim ~ year',
+                   formula_null = 'Clim ~ 1')
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
maxeval reached in nloptr(); nloptr() called again until apparent convergence of objective.
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fit_model", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("get_stat_effsizes")
> ### * get_stat_effsizes
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: get_stat_effsizes
> ### Title: Extracts statistics of interest or effect sizes for a specified
> ###   list of random-effects meta-analytical models
> ### Aliases: get_stat_effsizes
> 
> ### ** Examples
> 
> nb_cores <- 2L
> mod_T_prcs <- fit_all(data = dat_Clim,
+                       temperature = TRUE, precipitation = FALSE,
+                       phenology = TRUE, morphology = TRUE,
+                       condition = '1', nb_cores = nb_cores,
+                       rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0375; se = 0.0083"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 14.68826  1 0.0001268337
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
6.43e-01 2.80e+00 3.57e-01 8.35e+01 7.77e-06 3.80e-04 6.85e-04 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> mod_Sel_T_phen <- fit_all(data = dat_Sel,
+                           temperature = TRUE, precipitation = FALSE,
+                           phenology = TRUE, morphology = FALSE,
+                           condition = '3', nb_cores = nb_cores,
+                           rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.165; se = 0.0652"

########### Global ANOVA ###########
     chi2_LR df    p_value
p_v 5.718049  1 0.01679138
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
1.00e+00 3.35e+04 2.99e-05 5.10e+04 0.00e+00 1.24e-06 4.14e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> mod_list <- list(mod_T_prcs, mod_Sel_T_phen)
> 
> test_LRT <- get_stat_effsizes(list = mod_list, stat = 'LRT')
> test_LRT1 <- get_stat_effsizes(list = mod_list, stat = 'RandPub')
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("get_stat_effsizes", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("merge_3slopes")
> ### * merge_3slopes
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: merge_3slopes
> ### Title: Merges all three slopes by the respective data attributes
> ### Aliases: merge_3slopes
> 
> ### ** Examples
> 
> ## Not run: 
> ##D mod_T_prcs <- fit_all(data = dat_Clim,
> ##D                       temperature = TRUE, precipitation = FALSE,
> ##D                       phenology = TRUE, morphology = TRUE,
> ##D                       condition = '1', nb_cores = nb_cores,
> ##D                       rand_trait = FALSE, fixed = NULL, digit = digit)
> ##D mod_phen_T_prcs <- fit_all(data = dat_Trait, temperature = TRUE,
> ##D                             precipitation = FALSE, phenology = TRUE,
> ##D                             morphology = FALSE, condition = '2',
> ##D                             nb_cores = nb_cores, rand_trait = FALSE,
> ##D                             fixed = NULL, digit = digit)
> ##D mod_Sel_T_phen <- fit_all(data = dat_Sel,
> ##D                           temperature = TRUE, precipitation = FALSE,
> ##D                           phenology = TRUE, morphology = FALSE,
> ##D                           condition = '3', nb_cores = nb_cores,
> ##D                           rand_trait = FALSE, fixed = NULL,
> ##D                           digit = digit)
> ##D test <- merge_3slopes(meta_obj = mod_T_prcs,
> ##D                       meta_obj1 = mod_phen_T_prcs,
> ##D                       meta_obj2 = mod_Sel_T_phen)
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("merge_3slopes", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_eff_dur_firstY")
> ### * plot_eff_dur_firstY
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_eff_dur_firstY
> ### Title: Plots slopes of temperature vs. the duration of the studies and
> ###   vs. the first year in time series
> ### Aliases: plot_eff_dur_firstY
> 
> ### ** Examples
> 
>  ## Not run: 
> ##D      mod_T_prc <- fit_all(data = dat_Clim_prc,
> ##D                           temperature = TRUE, precipitation = FALSE,
> ##D                           phenology = TRUE, morphology = TRUE,
> ##D                           condition = '1', nb_cores = nb_cores,
> ##D                           rand_trait = FALSE, fixed = NULL, digit = digit)
> ##D      plot_eff_dur_firstY(data = dat_Clim_prc, meta_obj = mod_T_prc)
> ##D  
> ## End(Not run)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_eff_dur_firstY", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_forest")
> ### * plot_forest
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_forest
> ### Title: Produce a forest plot with effect sizes for each study id in
> ###   PRCS dataset and global effects for both PRCS and PRC datasets
> ### Aliases: plot_forest
> 
> ### ** Examples
> 
> nb_cores <- 2L
> meta_Trait_phen <- fit_all(data = dat_Trait, temperature = TRUE,
+                            precipitation = FALSE, phenology = TRUE,
+                            morphology = FALSE, condition = '2',
+                            nb_cores = nb_cores, rand_trait = FALSE,
+                            fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.248; se = 0.0637"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 10.96916  1 0.0009264073
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.05e-01 1.05e+01 9.53e-02 2.92e+02 1.95e-41 7.02e-03 6.66e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> meta_Trait_morph <- fit_all(data = dat_Trait, temperature = TRUE,
+                             precipitation = FALSE, phenology = FALSE,
+                             morphology = TRUE, condition = '2',
+                             nb_cores = nb_cores, rand_trait = FALSE,
+                             fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0353; se = 0.115"

########### Global ANOVA ###########
       chi2_LR df   p_value
p_v 0.09372053  1 0.7594995
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
5.94e-06 1.00e+00 1.00e+00 1.04e+00 7.91e-01 5.33e-02 3.17e-07 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> meta_Trait_phen_Tax <- fit_all(data = dat_Trait, temperature = TRUE,
+                                precipitation = FALSE, phenology = TRUE,
+                                morphology = FALSE, condition = '2',
+                                nb_cores = nb_cores, rand_trait = FALSE,
+                                fixed = 'Taxon', digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.265; se = 0.0651" "slope = 0.107; se = 0.299"  

########### Global ANOVA ###########
Fixed effect of  Taxon 
     chi2_LR df   p_value
p_v 1.578349  1 0.2089987
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.05e-01 1.05e+01 9.53e-02 2.92e+02 1.95e-41 7.02e-03 6.66e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> 
> test <- plot_forest(meta_obj1 = meta_Trait_phen$meta_res,
+                     meta_obj2 = meta_Trait_morph$meta_res,
+                     list_extra_meta_obj = list(meta_Trait_phen_Tax$meta_res),
+                     sort = c("Species", "Study_Authors", "Fitness_Categ"),
+                     increasing = TRUE,
+                     labels = c(traits = TRUE,
+                                fitness = TRUE,
+                                country = TRUE,
+                                authors = TRUE))
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_forest", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_funnel")
> ### * plot_funnel
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_funnel
> ### Title: Plots a funnel plot for the inspection of the potential
> ###   publication bias
> ### Aliases: plot_funnel
> 
> ### ** Examples
> 
> nb_cores <- 2L
> mod_T_prcs <- fit_all(data = dat_Clim,
+                       temperature = TRUE, precipitation = FALSE,
+                       phenology = TRUE, morphology = TRUE,
+                       condition = '1', nb_cores = nb_cores,
+                       rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   6%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |==========                                                            |  14%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |========================                                              |  34%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |====================================================                  |  74%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = 0.0375; se = 0.0083"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 14.68826  1 0.0001268337
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
6.43e-01 2.80e+00 3.57e-01 8.35e+01 7.77e-06 3.80e-04 6.85e-04 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> plot_funnel(meta_obj = mod_T_prcs)
> 
> mod_phen_T_prcs <- fit_all(data = dat_Trait,
+                            temperature = TRUE, precipitation = FALSE,
+                            phenology = TRUE, morphology = FALSE,
+                            condition = '2', nb_cores = nb_cores,
+                            rand_trait = FALSE, fixed = NULL, digit = 3)
  |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |======                                                                |   8%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  19%  |                                                                              |===============                                                       |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  32%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  86%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  92%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
 ######################################################### 
 Analysis of  ef_sizes 
 #########################################################

########### Global slope ###########
[1] "slope = -0.248; se = 0.0637"

########### Global ANOVA ###########
     chi2_LR df      p_value
p_v 10.96916  1 0.0009264073
      I2       H2    invH2        Q       Qp   vi.avg   lambda 
9.05e-01 1.05e+01 9.53e-02 2.92e+02 1.95e-41 7.02e-03 6.66e-02 

 # I2 is the proportion of variance between studies (the one caused by the random effect)
 # H2 is the inverse of the proportion of variance within studies
 # invH2 is the proportion of variance within studies
 # Q is the total heterogeneity (in a fixed effect model)
 # Qp is the p-value for the test Q = 0 (Q follows a chi-square distribution under the null hypothesis)
 # vi.avg is the average variance within study
 # lambda (also called tau^2) is the variance between studies
> plot_funnel(meta_obj = mod_phen_T_prcs)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_funnel", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_per_id")
> ### * plot_per_id
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_per_id
> ### Title: Plot data and fitted model per each study id
> ### Aliases: plot_per_id
> 
> ### ** Examples
> 
> plot_per_id(data = dat_Clim, temperature = TRUE,
+             precipitation = FALSE, phenology = TRUE,
+             morphology = TRUE, id = '1', condition = '1')
> 
> plot_per_id(data = dat_Trait, temperature = TRUE,
+             precipitation = FALSE, phenology = TRUE,
+             morphology = FALSE, id = '1', condition = '2')
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_per_id", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_raw")
> ### * plot_raw
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_raw
> ### Title: Plot raw data and the fitted model for the selected set of
> ###   studies
> ### Aliases: plot_raw
> 
> ### ** Examples
> 
> ## Not run: 
> ##D pdf('./test_sel.pdf', height = 10, width = 7)
> ##D par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
> ##D plot_raw(data = dat_Sel, temperature = TRUE,
> ##D          precipitation = FALSE, phenology = TRUE,
> ##D          morphology = FALSE, condition = '3',
> ##D          id_to_do = c(1:19))
> ##D dev.off()
> ##D 
> ##D pdf('./test_traits.pdf', height = 10, width = 7)
> ##D par(oma = c(2, 2, 0, 0), mar = c(1, 2, 3, 1))
> ##D plot_raw(data = dat_Trait, temperature = TRUE,
> ##D          precipitation = FALSE, phenology = TRUE,
> ##D          morphology = FALSE, condition = '2',
> ##D          id_to_do = c(1:20))
> ##D dev.off()
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_raw", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_sel_per_id")
> ### * plot_sel_per_id
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_sel_per_id
> ### Title: Plot selection data and WMS per each study id
> ### Aliases: plot_sel_per_id
> 
> ### ** Examples
> 
> plot_sel_per_id(data = dat_Sel, temperature = TRUE,
+                 precipitation = FALSE, phenology = TRUE,
+                 morphology = FALSE, id = '1', condition = '3')
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_sel_per_id", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("prepare_colours")
> ### * prepare_colours
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: prepare_colours
> ### Title: Create the colours for the forest plots
> ### Aliases: prepare_colours
> 
> ### ** Examples
> 
> ## Not run: 
> ##D nb_cores <- 2L
> ##D meta_Sel_phen <- fit_all(data = dat_Sel,
> ##D                          temperature = TRUE, precipitation = FALSE,
> ##D                          phenology = TRUE, morphology = FALSE,
> ##D                          condition = '3', nb_cores = nb_cores,
> ##D                          rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D meta_Sel_morph <- fit_all(data = dat_Sel,
> ##D                           temperature = TRUE, precipitation = FALSE,
> ##D                           phenology = FALSE, morphology = TRUE,
> ##D                           condition = '3', nb_cores = nb_cores,
> ##D                           rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D 
> ##D test1 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res)
> ##D 
> ##D test2 <- prepare_slopes(meta_obj2 = meta_Sel_phen$meta_res)
> ##D 
> ##D test3 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                         meta_obj2 = meta_Sel_morph$meta_res)
> ##D 
> ##D test_col_1 <- prepare_colours(test1)
> ##D test_col_2 <- prepare_colours(test2)
> ##D test_col_3 <- prepare_colours(test3)
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("prepare_colours", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("prepare_data_plot")
> ### * prepare_data_plot
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: prepare_data_plot
> ### Title: Prepare the data for the forest plots
> ### Aliases: prepare_data_plot
> 
> ### ** Examples
> 
> ## Not run: 
> ##D nb_cores <- 2L
> ##D meta_Sel_phen <- fit_all(data = dat_Sel,
> ##D                          temperature = TRUE, precipitation = FALSE,
> ##D                          phenology = TRUE, morphology = FALSE,
> ##D                          condition = '3', nb_cores = nb_cores,
> ##D                          rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D meta_Sel_morph <- fit_all(data = dat_Sel,
> ##D                           temperature = TRUE, precipitation = FALSE,
> ##D                           phenology = FALSE, morphology = TRUE,
> ##D                           condition = '3', nb_cores = nb_cores,
> ##D                           rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D lab1 <- prepare_labels(meta_obj = meta_Sel_phen$meta_res,
> ##D                        labels = c(traits = TRUE,
> ##D                                   fitness = TRUE,
> ##D                                   country = TRUE,
> ##D                                   authors = TRUE),
> ##D                       sort = c("Species"),
> ##D                       increasing = TRUE)
> ##D 
> ##D lab2 <-  prepare_labels(meta_obj = meta_Sel_morph$meta_res,
> ##D                        labels = c(traits = TRUE,
> ##D                                   fitness = TRUE,
> ##D                                   country = TRUE,
> ##D                                   authors = TRUE),
> ##D                       sort = c("Species"),
> ##D                       increasing = TRUE)
> ##D 
> ##D 
> ##D test1 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                        labels_obj1 = lab1,
> ##D                        labels_obj2 = lab2)
> ##D 
> ##D test2 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                         meta_obj2 = meta_Sel_morph$meta_res,
> ##D                         labels_obj1 = lab1,
> ##D                         labels_obj2 = lab2,
> ##D                         list_extra_meta_obj = list(meta_Sel_phen$meta_res,
> ##D                                                   meta_Sel_morph$meta_res,
> ##D                                                   mod_Sel_T_phen_Fitn$meta_res))
> ##D 
> ##D test_col_1 <- prepare_colours(test1)
> ##D test_col_2 <- prepare_colours(test2)
> ##D prep_data_test1 <- prepare_data_plot(test_col_1)
> ##D prep_data_test2 <- prepare_data_plot(test_col_2)
> ## End(Not run)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("prepare_data_plot", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("prepare_labels")
> ### * prepare_labels
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: prepare_labels
> ### Title: Create the labels for the forest plots
> ### Aliases: prepare_labels
> 
> ### ** Examples
> 
> ## Not run: 
> ##D dat_sel_phen <- prepare_data(data = dat_Sel,
> ##D                              temperature = TRUE, precipitation = FALSE,
> ##D                              phenology = TRUE, morphology = FALSE)
> ##D test_sel <- extract_effects_all_ids(data = dat_sel_phen,
> ##D                                     condition = '3', nb_cores = nb_cores)
> ##D test_meta_sel <- fit_meta(test_sel)
> ##D prepare_labels(meta_obj = test_meta_sel,
> ##D                labels = c(traits = TRUE,
> ##D                           fitness = TRUE,
> ##D                           country = TRUE,
> ##D                           authors = TRUE),
> ##D                sort = c("Species", "Study_Authors", "Fitness_Categ"),
> ##D                increasing = TRUE)
> ## End(Not run)
> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("prepare_labels", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("prepare_slopes")
> ### * prepare_slopes
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: prepare_slopes
> ### Title: Prepare the slopes for the forest plots
> ### Aliases: prepare_slopes
> 
> ### ** Examples
> 
> ## Not run: 
> ##D nb_cores <- 2L ## increase the number for using more cores
> ##D meta_Sel_phen <- fit_all(data = dat_Sel,
> ##D                          temperature = TRUE, precipitation = FALSE,
> ##D                          phenology = TRUE, morphology = FALSE,
> ##D                          condition = '3', nb_cores = nb_cores,
> ##D                          rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D meta_Sel_morph <- fit_all(data = dat_Sel,
> ##D                           temperature = TRUE, precipitation = FALSE,
> ##D                           phenology = FALSE, morphology = TRUE,
> ##D                           condition = '3', nb_cores = nb_cores,
> ##D                           rand_trait = FALSE, fixed = NULL, digit = 3)
> ##D 
> ##D meta_Sel_phen_Fitn <- fit_all(data = dat_Sel,
> ##D                               temperature = TRUE, precipitation = FALSE,
> ##D                               phenology = TRUE, morphology = FALSE,
> ##D                               condition = '3', nb_cores = nb_cores,
> ##D                               rand_trait = FALSE, fixed = 'Fitness_Categ',
> ##D                               digit = 3)
> ##D 
> ##D test1 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res)
> ##D 
> ##D test2 <- prepare_slopes(meta_obj2 = meta_Sel_phen$meta_res)
> ##D 
> ##D test3 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                         meta_obj2 = meta_Sel_morph$meta_res)
> ##D 
> ##D test4 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                         list_extra_meta_obj =
> ##D                         list(meta_Sel_phen_Fitn$meta_res))
> ##D 
> ##D test5 <- prepare_slopes(meta_obj1 = meta_Sel_phen$meta_res,
> ##D                         meta_obj2 = meta_Sel_morph$meta_res,
> ##D                         list_extra_meta_obj =
> ##D                         list(meta_Sel_phen_Fitn$meta_res))
> ##D 
> ##D test6 <- prepare_slopes(meta_obj1 = meta_Sel_phen_Fitn$meta_res,
> ##D                         list_extra_meta_obj =
> ##D                         list(meta_Sel_morph$meta_res,
> ##D                         meta_Sel_phen$meta_res))
> ## End(Not run)
> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("prepare_slopes", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("save_xlsx")
> ### * save_xlsx
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: save_xlsx
> ### Title: Save a table in the *.xlsx format
> ### Aliases: save_xlsx
> 
> ### ** Examples
> 
> d <- data.frame(test = 1:5, id = LETTERS[1:5],
+                 a= seq(from = 0.01, to = 0.05, by = 0.01),
+                 test = 1:5, id = LETTERS[1:5],
+                 p = c('<0.001', '0.002', '0.260', '<0.001', '0.987'))
> dir.create('tables')
> save_xlsx(table = d, table_basename = './tables/test1',
+           typeTab = 'LRT')
Note: zip::zip() is deprecated, please use zip::zipr() instead
[1] "The table has been created and is saved at location: /Users/alex/Dropbox/Boulot/Mes_projets_de_recherche/R_packages/adRes_project/adRes.Rcheck/tables/test1.xlsx"
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("save_xlsx", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  633.973 5.859 2559.166 0.102 0.131 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
